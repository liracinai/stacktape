serviceName: web-gatsby

scripts:
  build:
    # or "yarn build"
    executeCommand: npm run build

hooks:
  beforeDeploy:
    # when executing in CI environment install dependencies
    - executeCommand: npm ci # or "yarn install --frozen-lockfile"
      skipOnLocal: true
    # build project before deploy
    - executeNamedScript: build
  beforeBucketSync:
    - executeCommand: build

resources:
  webBucket:
    type: bucket
    properties:
      directoryUpload:
        directoryPath: ./public
        headersPreset: gatsby-static-website
      cdn:
        enabled: true
        invalidateAfterDeploy: true
